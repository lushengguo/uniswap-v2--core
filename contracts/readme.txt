overview:
一对token(这里token可以理解为一种代币)构成一个流动性池 流动性池之间是独立的
每次有人往流动性池里面加两种token - 即提供流动性, 就会获得与输入的token等比例的LP
LP也是一种token, 用于代表用户提供的流动性在整个流动池里面占比, 只不过只在uniswap合约里有效

流动性池提供了什么功能?
1. 链上的用户可以用tokenA换池子里的tokenB (需要额外缴纳一部分的手续费)
2. 流动性提供者可以往里面放代币, 以此来获得手续费分红 

AMM:
中文名自动化做市商, 会根据市场需求动态的调整两个币之间的兑换比例;
流动性提供者必须按totalTokenA/totalTokenB的比例往池子里面放代币
用户也必须用totalTokenA/totalTokenB的比例从池子里兑换另一种代币出来
当用户提供了tokenA, 获得了tokenB, 池子里的tokenB就会减少, tokenA会增加
这时候每个tokenB就能兑换更多的tokenA, 流动性足够大的时候, 两种代币的价格不会剧烈波动

当用户提供流动性的时候, 会获得一定的LP
- 如果池子里完全没有token, 那么获得的LP为sqrt(inputTokenA*inputTokenB)
- 如果池子里有token 且比例为a:b 那么流动性提供者也只能按a:b的比例来提供两种token(实际接口可以输入不成比例的token, 但多余的token会被退还)
- 然后流动性提供者获得
- min((totalSupply/totalTokenA)*inputTokenA, totalSupply/totalTokenB/inputTokenB)个LP
- 为什么会算min? 因为注入的token比例和池子里的token比例之间允许有一小部分的误差
当用户提现的时候, 这些LP会被销毁, 能够提现的金额为 (用户自己的LP/总的LP)*流动池里的token总数

手续费:
- 有用户产生交易的时候(用tokenA交换tokenB)额外提供a%的手续费(手续费就是两种token)
- 手续费纳入流动性池内 成为池内的总资产 提现的时候流动性提供者根据自己的LP占比来获得池内的部分代币
- 合约的开发人员可以指定一个地址来分这些手续费
- 手续费一般是0.3% 开发人员获得手续费的1/6 流动性提供者按照自己的LP代币占总的比例来获得另外的5/6
- 上面这种分红的实现方式是, 当有新的手续费入池的时候, 流动性提供者的LP不变 (因为池子变大了 他们一定是可以多分到代币的)
- 给开发人员增发一些LP, 用于稀释流动性提供者的LP, 稀释的比例控制得当, 就能实现上面说的1:5
- 开发人员在部署智能合约的时候可以指定一个收款地址和一个管理员地址
- 管理员只可以更换开发人员的那个收款地址 这也让用户对这个合约放心